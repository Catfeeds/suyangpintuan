<?phpclass Form_Library {	/**	 * 下拉选择框	 */	public static function select($array = array(), $id = 0, $str = '', $default_option = '', $default_value = '', $str_start = '', $str_end = '') {		$string = $str_start . '<select ' . $str . '>';		$default_selected = (empty($id) && $id !== 0 && $default_option) ? 'selected' : '';		if ($default_option) {			$string .= "<option value='" . $default_value . "' $default_selected>$default_option</option>";		}		if ((!is_array($array) || count($array) == 0) && $default_option == '') {			return false;		}		$ids = array();		if (isset($id)) {			$ids = explode(',', $id);		}		foreach ($array as $key => $value) {			$selected = (in_array($key, $ids) && $id !== '') ? ' selected' : '';			$v        = $value;			$disabled = '';			if (is_array($value)) {				$v = $value[0];				if ($value[1] == 'disabled') {					$disabled = ' disabled';				}			}			$string .= '<option value="' . $key . '" ' . $disabled . $selected . '>' . $v . '</option>';		}		$string .= '</select>' . $str_end;		return $string;	}	/**	 * 复选框	 */	public static function checkbox($array = array(), $id = '', $str = '', $defaultvalue = '', $width = 0, $field = '') {		$string = '';		$style = $width ? 'style="float:left;width:' . $width . 'px;"' : '';		$id = trim($id);		if ($id != '') {			$id = strpos($id, ',') ? explode(',', $id) : array($id);		}		if ($defaultvalue) {			$string .= '<input type="hidden" ' . $str . ' value="-99">';		}		$i = 1;		foreach ($array as $key => $value) {			$key = trim($key);			$checked = ($id && in_array($key, $id)) ? 'checked' : '';			$string .= '<label ' . $style . '>';			$string .= '<input type="checkbox" ' . $str . ' id="' . $field . '_' . $i . '" ' . $checked . ' value="' . $key . '"> ' . $value;			$string .= '</label> &nbsp;';			$i++;		}		return $string;	}	/**	 * 单选框	 */	public static function radio($array = array(), $id = 0, $str = '', $width = 0, $field = '') {		$string = '';		$style = $width ? 'style="float:left;width:' . $width . 'px;"' : '';		foreach ($array as $key => $value) {			$checked = trim($id) == trim($key) ? 'checked' : '';			$string .= '<label ' . $style . '>';			$string .= '<input type="radio" ' . $str . ' id="' . $field . '_' . $key . '" ' . $checked . ' value="' . $key . '"> ' . $value;			$string .= '</label> &nbsp;';		}		return $string;	}	/**	 * 编辑器	 */	public static function editor($field, $value = '', $str = '', $info = array('toolbar' => 'full')) {		global $lowxp;		$edit_options = "[            'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',            'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',            'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',            'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',            'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',            'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',            'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',            'anchor', 'link', 'unlink'        ]";		if ($info['toolbar'] == 'basic') {			$edit_options = "[                'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold', 'italic', 'underline',                'removeformat', '|', 'justifyleft', 'justifycenter', 'justifyright', 'insertorderedlist',                'insertunorderedlist', '|', 'emoticons', 'image', 'link','|','source','fullscreen'            ]";		}		if ($lowxp->mod == 'manage' || $lowxp->mod == 'business') {			$str = '<textarea id="editor_' . $field . '" ' . $str . '>' . stripcslashes($value) . '</textarea><pre class="editorPre">' . stripcslashes($value) . '</pre>';            $str .= '<script type="text/javascript">$.loadJs("/admin/js/edit/kindeditor.js",function(){ $.loadJs("/admin/js/edit/lang/zh_CN.js",function(){ com.initEdit("#editor_' . $field . '",' . $edit_options . '); })})</script>';		} else {			$str = '<textarea name="' . $field . '" ' . $str . '>' . stripcslashes($value) . '</textarea><pre class="editorPre">' . stripcslashes($value) . '</pre>';			$str .= '<script type="text/javascript" src="/admin/js/_edit/kindeditor.js"></script><script type="text/javascript" src="/admin/js/_edit/lang/zh_CN.js"></script>            <script type="text/javascript">            KindEditor.ready(function(K){                var editor1 = K.create(\'textarea[name="' . $field . '"]\', {});            });            </script>';		}		return $str;	}	/** 上传控件	 * @param $field 唯一字段名	 * @param $value json默认值	 * @param $str   按钮文本	 * @param $os    上传配置	 * @param $o     其它配置	 * @return string	 */	public static function files($field, $value, $str = '上传图片', $os = array(), $o = array()) {		$os = array_merge(array(			'type' => 'image',            'watermark'=>0,		), $os);		$o = array_merge(array(			'id'        => 'upFiles_' . $field,			'namePath'  => 'post[' . $field . '][path][]',			'nameTitle' => 'post[' . $field . '][title][]',            'appurl'      =>0,			'nameIosurl'  => 'post[' . $field . '][iosurl][]',			'nameAnurl'   => 'post[' . $field . '][anurl][]',			'nameSurl'   => 'post[' . $field . '][surl][]',		), $o);		$class = ($os['type'] == 'file') ? 'BtnBlue' : 'BtnOrange';		if (!is_array($value)) {			$value = json_decode($value, true);		}		$html = '<input type="hidden" name="post[' . $field . ']" value="" />';        if (!empty($value)) {            foreach ($value as $k => $v) {                if($o['appurl']==1){                    $html .= '<div><input type="text" class="form-i inputPath" name="' . $o['namePath'] . '" value="' . $v['path'] . '">' .                        '<input type="text" class="form-i inputPath" name="' . $o['nameTitle'] . '" value="' . $v['title'] . '"> ' .                        '<a href="' . yunurl($v['path']) . '" target="_blank" class="iconfont c-green seePic" title="查看缩略图" onmousemove="main.seepic(this)">&#xe602;<span><img src="' . yunurl($v['path']) . '" onerror="this.hide()" /></span></a> ' .                        '<a href="javascript:;" class="a-del" title="移除" onclick="[this.parentNode].remove()">×</a> ' .                        '<br><input type="text" placeholder="苹果链接" class="form-i inputPath" name="' . $o['nameIosurl'] . '" value="' . $v['iosurl'] . '">'.                        '<input type="text" placeholder="安卓链接" class="form-i inputPath" name="' . $o['nameAnurl'] . '" value="' . $v['anurl'] . '">'.                        '<input type="text" placeholder="小程序链接" class="form-i inputPath" name="' . $o['nameSurl'] . '" value="' . $v['surl'] . '">'.                        '</div>';                }else{                    $html .= '<div><input type="text" class="form-i inputPath" name="' . $o['namePath'] . '" value="' . $v['path'] . '">' .                        '<input type="text" class="form-i inputTitle" name="' . $o['nameTitle'] . '" value="' . $v['title'] . '"> ' .                        '<a href="' . yunurl($v['path']) . '" target="_blank" class="iconfont c-green seePic" title="查看缩略图" onmousemove="main.seepic(this)">&#xe602;<span><img src="' . yunurl($v['path']) . '" onerror="this.hide()" /></span></a> ' .                        '<a href="javascript:;" class="a-del" title="移除" onclick="[this.parentNode].remove()">×</a> ' .                        '</div>';                }            }        }		$tips = ' <span class="form-tip">';		$tips .= ((isset($os['maxnum']) ? $os['maxnum'] : 0) > 1) ? '数量限制（' . $os['maxnum'] . '）' : '';		$tips .= intval((isset($os['file_size_limit']) ? $os['file_size_limit'] : 0)) ? '大小限制（' . $os['file_size_limit'] . '以内）' : '';		$tips .= (isset($os['file_types']) ? $os['file_types'] : '') ? '文件格式（' . $os['file_types'] . '）' : '';		$tips .= '</span>';		$tips = '';		$str = '<div id="upFiles_' . $field . '" class="filesBox">' . $html . '</div><a href="javascript:;" class="uiBtn ' . $class . '" onclick=\'upfiles.files(' . json_encode($os) . ',' . json_encode($o) . ')\'>' . $str . '</a>' . $tips;		$str .= "<script type='text/javascript'>$.loadJs('/admin/js/upload.js',function(){ $.loadJs('/admin/js/manage/upfiles.js',function(){ }) })</script>";		return $str;	}	/**	 * SWFUPLOAD上传控件(前台使用)	 * $input表单名	 * 缩放宽$width高$height	 * $limit限制上传个数	 */	public static function upload_files($input, $width = '', $height = '', $limit = 1, $file_types = '*.jpg;*.gif;*.png', $file_size = '10 MB') {		$html = '<link type="text/css" rel="stylesheet" href="' . url() . 'style/js/swf_up/swfupload.css" />';		$html .= '<div class="fieldset flash" id="' . $input . '_fsUploadProgress"></div>';		if ($limit > 1) {		}		$display = $limit == 1 ? 'style="display:none;"' : '';		if ($limit) {			$tips = $input != 'photo' ? '<span style="margin-left:5px; color:#666;">(可同时选择上传' . $limit . '张图片,图片不大于10240KB)</span>' : '';		} else {			$tips = $input != 'photo' ? '<span style="margin-left:5px; color:#666;">(图片不大于10240KB)</span>' : '';		}		$html .= '<div id="divStatus" ' . $display . '>0 个文件已上传</div>';		$html .= '<div style="padding-top:5px;"><span id="spanButtonPlaceHolder"></span><input id="btnCancel" type="button" value="取消所有上传" ' . $display . ' onclick="swfu.cancelQueue();" disabled="disabled"/>' . $tips . '</div><div id="' . $input . 'upload_success"></div>';		//上传成功执行的JS		if ($limit == 1) {			$js = "$('#" . $input . "').attr('src',serverData);\n$('#" . $input . "upload_success').html('<input type=\"hidden\" name=\"" . $input . "\" value=\"'+serverData+'\"/>');";		} else {			$js = "$('#" . $input . "upload_success').append('<input type=\"hidden\" name=\"" . $input . "[]\" value=\"'+serverData+'\"/>');";		}		$html .= "<script type=\"text/javascript\" src=\"/style/js/swf_up/swfupload.js\"></script>                <script type=\"text/javascript\" src=\"/style/js/swf_up/swfupload.queue.js\"></script>                <script type=\"text/javascript\" src=\"/style/js/swf_up/fileprogress.js\"></script>                <script type=\"text/javascript\" src=\"/style/js/swf_up/handlers.js\"></script>                <script type=\"text/javascript\">                    var swfu;                    $(function() {                        var settings = {                            flash_url : '/style/js/swf_up/swfupload.swf',                            upload_url: '/home/upload',                            file_size_limit : '" . $file_size . "',                            file_types : '" . $file_types . "',                            file_types_description : 'All Files',                            file_upload_limit : " . $limit . ",  //配置上传个数                            file_queue_limit : 0,                            custom_settings : {                                progressTarget : '" . $input . "_fsUploadProgress',                                cancelButtonId : 'btnCancel'                            },                            debug: false,                            post_params:  { 'name' : '" . $input . "', 'width' : '" . $width . "', 'height' : '" . $height . "' } ,                            // Button settings                            button_image_url: '/style/js/swf_up/upload.jpg',                            button_width: '68',                            button_height: '26',                            button_placeholder_id: 'spanButtonPlaceHolder',                            file_queued_handler : fileQueued,                            file_queue_error_handler : fileQueueError,                            file_dialog_complete_handler : fileDialogComplete,                            upload_start_handler : uploadStart,                            upload_progress_handler : uploadProgress,                            upload_error_handler : uploadError,                            upload_success_handler : " . $input . "uploadSuccess,                            upload_complete_handler : uploadComplete,                            queue_complete_handler : queueComplete,                            file_post_name:'upFile'                        };                        swfu = new SWFUpload(settings);                        //$('#upload_btn').click(function(){ if(swfu.getStats().files_queued){swfu.startUpload();}else{ $('#submit_form').submit(); } });                     });                    function " . $input . "uploadSuccess(file, serverData) {                        try {                            " . $js . "                            var progress = new FileProgress(file, this.customSettings.progressTarget);                            progress.setComplete();                            progress.setStatus('上传成功');                            progress.toggleCancel(false);                        } catch (ex) {                            this.debug(ex);                        }                    }                </script>";		return $html;	}}?>